(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      7888,        221]
NotebookOptionsPosition[      7244,        201]
NotebookOutlinePosition[      7719,        219]
CellTagsIndexPosition[      7676,        216]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[" \[OpenCurlyDoubleQuote]Hump-backed plateau\[CloseCurlyDoubleQuote]", \
"Title",ExpressionUUID->"333a0815-cdb0-44c7-bec8-316df1cbc2d2"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\</Users/gianmicheleinnocenti/Desktop/parton-shower-simulator/Kernel/\
PartonShowerMCFull.wl\>\""}]], "Input",ExpressionUUID->"b4cb4767-7fea-4194-\
ae88-ba6ae7118a2c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxevents", "=", " ", "500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ptinitial", "=", "100."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"descendtot", " ", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zvaluestot", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nmultiplicitytot", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nmultiplicityquarkstot", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nquarkstot", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "0"}], ",", " ", 
   RowBox[{"i", "<", "maxevents"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"descendentevent", ",", "zvaluesevent"}], "]"}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"descendentevent", " ", "=", " ", 
     RowBox[{"ShowerFixed", "[", 
      RowBox[{
      "ptinitial", ",", "1.", ",", "SudakovPgtoggvacuumNT", ",", " ", 
       "SudakovPgtoqqbarvacuumLT", ",", "1"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"zvaluesevent", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"descendentevent", "[", 
          RowBox[{"[", "jendex", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/", "ptinitial"}], ",", 
       RowBox[{"{", 
        RowBox[{"jendex", ",", 
         RowBox[{"Length", "[", "descendentevent", "]"}]}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"nquarks", "=", 
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"descendentevent", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "2"}], "]"}], "]"}], ",", "\"\<q\>\""}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"descendtot", ",", "descendentevent"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"zvaluestot", ",", "zvaluesevent"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"nmultiplicitytot", ",", 
      RowBox[{"Length", "[", "descendentevent", "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"nmultiplicityquarkstot", ",", "nquarks"}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meannquarks", " ", "=", " ", 
   RowBox[{
    RowBox[{"Mean", "[", "nmultiplicityquarkstot", "]"}], "*", "1.000001"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meanmult", " ", "=", " ", 
   RowBox[{
    RowBox[{"Mean", "[", "nmultiplicitytot", "]"}], "*", "1.000001"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Mean multiplicty=\>\"", ",", " ", "meanmult"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean multiplicty quarks =\>\"", ",", " ", "meannquarks"}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{"nmultiplicitytot", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.5"}], ",", "300.5", ",", "10."}], "}"}], ",", 
   "\"\<Probability\>\"", ",", " ", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"HoldForm", "[", "\"\<Parton multiplicity\>\"", "]"}], ",", 
      RowBox[{"HoldForm", "[", "Entries", "]"}]}], "}"}]}], ",", " ", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{
     RowBox[{
     "StringTemplate", "[", 
      "\"\<Distribution of Log[\!\(\*FractionBox[\(1\), \(x\)]\)] for initial \
gluon of `1` GeV\>\"", "]"}], "[", "ptinitial", "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"LabelStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", " ", "12", 
      ",", " ", 
      RowBox[{"GrayLevel", "[", "0", "]"}]}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{"nmultiplicityquarkstot", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.5"}], ",", "30.5", ",", "1."}], "}"}], ",", 
   "\"\<Probability\>\"", ",", " ", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"HoldForm", "[", "\"\<Quark multiplicity\>\"", "]"}], ",", 
      RowBox[{"HoldForm", "[", "Entries", "]"}]}], "}"}]}], ",", " ", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{
     RowBox[{
     "StringTemplate", "[", 
      "\"\<Distribution of Log[\!\(\*FractionBox[\(1\), \(x\)]\)] for initial \
gluon of `1` GeV\>\"", "]"}], "[", "ptinitial", "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"LabelStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", " ", "12", 
      ",", " ", 
      RowBox[{"GrayLevel", "[", "0", "]"}]}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{
   RowBox[{"Log", "[", 
    RowBox[{"1", "/", 
     RowBox[{"Flatten", "[", "zvaluestot", "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.", ",", "10.", ",", "0.1"}], "}"}], ",", "\"\<Probability\>\"",
    ",", " ", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"HoldForm", "[", 
       RowBox[{"Log", "[", 
        FractionBox["1", "x"], "]"}], "]"}], ",", 
      RowBox[{"HoldForm", "[", "Entries", "]"}]}], "}"}]}], ",", " ", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{
     RowBox[{
     "StringTemplate", "[", 
      "\"\<Distribution of Log[\!\(\*FractionBox[\(1\), \(x\)]\)] for initial \
gluon of `1` GeV\>\"", "]"}], "[", "ptinitial", "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"LabelStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", " ", "12", 
      ",", " ", 
      RowBox[{"GrayLevel", "[", "0", "]"}]}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], "Input",ExpressionUUI\
D->"72e4f3fe-9ecb-49e5-8c1b-9064a3c14f65"]
}, Open  ]]
},
WindowSize->{1115, 885},
WindowMargins->{{167, Automatic}, {Automatic, 0}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>0.75 Inherited,
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0cc54c80-78b8-4291-840b-a2790758a248"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 141, 1, 75, "Title",ExpressionUUID->"333a0815-cdb0-44c7-bec8-316df1cbc2d2"],
Cell[724, 25, 202, 4, 22, "Input",ExpressionUUID->"b4cb4767-7fea-4194-ae88-ba6ae7118a2c"],
Cell[929, 31, 6299, 167, 588, "Input",ExpressionUUID->"72e4f3fe-9ecb-49e5-8c1b-9064a3c14f65"]
}, Open  ]]
}
]
*)

